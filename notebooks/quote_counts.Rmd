---
title: "Quote counts"
output: html_notebook
---

```{r packages}
library(tidyverse)
library(drake)
library(lubridate)
```

```{r data}
loadd(data_mutate)

cutoff <- as_date("2019-01-25")
window <- 43

df <- data_mutate %>% 
  filter(pub_date>cutoff-window & pub_date<cutoff+window) 
```

```{r}
test <- df %>% head(1) %>% pull(text_body)

df <- df %>% 
  mutate(quotes=str_count(text_body, pattern='"')/2)

%>% 
  ggplot(aes(quotes)) + 
  geom_histogram()

df %>% 
  group_by(pub_date) %>% 
  summarize(has_tweet=sum(has_tweet)/n(), quotes=sum(quotes>0)/n()) %>%  
  pivot_longer(c(has_tweet, quotes), names_to="measure") %>% 
  ggplot(aes(pub_date, value, color=measure)) + 
    geom_line() + 
  geom_vline(xintercept=cutoff)
```

