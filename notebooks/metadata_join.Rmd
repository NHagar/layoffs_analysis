---
title: "metadata_join"
author: "Nick Hagar"
date: "1/26/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries}
library(tidyverse)
library(lubridate)
```


```{r loaddata}
layoffs <- read_csv('../data/layoffs_lists_joined.csv')
layoffs <- layoffs %>% rename('names'=`0`) %>% select(names)

df <- read_csv('../data/scraped_stories_sections.csv')
df <- df %>% separate(pub_date, c('f', 'l'), sep='Posted on ') %>% separate(l, c('datel', 'l2'), sep=', at') %>% 
  filter(!is.na(datel)) %>% mutate(pub_date=mdy(datel)) %>% select(-f, -l2, -datel)
df_meta <- df %>% select(-text_body)
```

```{r cleantext}
layoffs <- layoffs %>% 
  mutate(byline_cleaned =  gsub('[[:punct:] ]+','',tolower(names)))

df_meta <- df_meta %>% 
  mutate(byline_cleaned =  gsub('[[:punct:] ]+','',tolower(byline))) %>% 
  mutate(laid_off=ifelse(byline_cleaned %in% layoffs$byline_cleaned, 1, 0))
```

```{r sectiondata}


```

